<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Demand Planner</title>
  <link rel="stylesheet" href="style.css">
  <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
</head>
<body>

<div class="container">
  <h1>Demand Planning Tool</h1>

  <!-- INPUTS -->
  <div class="card">
    <label>Sales File</label>
    <input type="file" id="salesFile">

    <label>Stock File</label>
    <input type="file" id="stockFile">

    <div class="inputs">
      <div>
        <label>Sales Days</label>
        <input type="number" id="salesDays" value="30">
      </div>
      <div>
        <label>Target Stock Cover</label>
        <input type="number" id="targetSC" value="45">
      </div>
    </div>

    <button onclick="processFiles()">Generate Reports</button>
  </div>

  <!-- SC BAND SUMMARY -->
  <div class="card">
    <h2>üìä Stock Cover Band Summary (Style Level)</h2>
    <table>
      <tr><th>SC Band</th><th>Styles</th></tr>
      <tr><td>0‚Äì30</td><td id="b0">0</td></tr>
      <tr><td>30‚Äì60</td><td id="b30">0</td></tr>
      <tr><td>60‚Äì120</td><td id="b60">0</td></tr>
      <tr><td>120+</td><td id="b120">0</td></tr>
    </table>
  </div>

  <!-- SEARCH + EXPORT -->
  <div class="actions">
    <input id="search" placeholder="Search style (works in all tabs)">
    <button onclick="exportFullReport()">üì§ Export Full Report</button>
  </div>

  <!-- TABS -->
  <div class="tabs">
    <button class="tab-btn active" onclick="showTab('demand')">üìä Demand</button>
    <button class="tab-btn" onclick="showTab('overstock')">üì¶ Overstock</button>
    <button class="tab-btn" onclick="showTab('sizemix')">üìê Size Mix %</button>
    <button class="tab-btn" onclick="showTab('sizeanalysis')">üìä Size Analysis</button>
    <button class="tab-btn" onclick="showTab('sizecurve')">üßÆ Size Curve</button>
  </div>

  <!-- DEMAND -->
  <div id="demandTab" class="tab-content active">
    <div class="card">
      <table id="demandTable">
        <thead>
          <tr>
            <th></th><th>Style</th><th>Sales</th><th>Stock</th>
            <th>DRR</th><th>SC</th><th>Demand</th>
          </tr>
        </thead>
        <tbody></tbody>
      </table>
    </div>
  </div>

  <!-- OVERSTOCK -->
  <div id="overstockTab" class="tab-content">
    <div class="card">
      <table id="overstockTable">
        <thead>
          <tr>
            <th></th><th>Style</th><th>Sales</th><th>Stock</th>
            <th>DRR</th><th>SC</th>
          </tr>
        </thead>
        <tbody></tbody>
      </table>
    </div>
  </div>

  <!-- SIZE MIX -->
  <div id="sizemixTab" class="tab-content">
    <div class="card">
      <table id="sizeMixTable">
        <thead>
          <tr>
            <th>Style</th>
            <th>Total Sales</th>
            <th>Normal %</th>
            <th>Plus1 %</th>
            <th>Plus2 %</th>
          </tr>
        </thead>
        <tbody></tbody>
      </table>
    </div>
  </div>

  <!-- SIZE ANALYSIS -->
  <div id="sizeanalysisTab" class="tab-content">
    <div class="card">
      <table id="sizeAnalysisTable">
        <tr><th>Category</th><th>Units</th><th>% Share</th></tr>
        <tr><td>Normal (S‚ÄìXXL)</td><td id="normalSales">0</td><td id="normalPct">0%</td></tr>
        <tr><td>Plus1 (3XL‚Äì6XL)</td><td id="plus1Sales">0</td><td id="plus1Pct">0%</td></tr>
        <tr><td>Plus2 (7XL‚Äì10XL)</td><td id="plus2Sales">0</td><td id="plus2Pct">0%</td></tr>
      </table>
    </div>
  </div>

  <!-- SIZE CURVE -->
  <div id="sizecurveTab" class="tab-content">
    <div class="card">
      <h2>Style-wise Size Curve Recommendation</h2>

      <!-- HELP -->
      <div class="help-box">
        <b>How to read this:</b><br>
        ‚Ä¢ <b>Style Demand</b> = units needed to maintain target stock cover<br>
        ‚Ä¢ Recommendation splits demand by <b>actual size sales mix</b><br>
        ‚Ä¢ Sizes with high stock cover get lower allocation<br>
        ‚Ä¢ Sizes with low stock cover get higher allocation<br>
        ‚Ä¢ Use this directly to create PO size quantities
      </div>

      <table id="sizeCurveTable">
        <thead>
          <tr>
            <th>Style</th>
            <th>Style Demand</th>
            <th>Recommended Buy (Size : Qty)</th>
          </tr>
        </thead>
        <tbody></tbody>
      </table>
    </div>
  </div>

</div>

<script src="app.js"></script>
</body>
</html>
