<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Demand Planner – V1.1</title>
  <link rel="stylesheet" href="style.css" />
  <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
</head>
<body>

<div class="container">
  <h1>Demand Planning Tool</h1>

  <!-- CONTROL BAR -->
  <div class="card control-bar">
    <div class="control-group">
      <label>Sales File</label>
      <input type="file" id="salesFile" />
    </div>

    <div class="control-group">
      <label>Stock File</label>
      <input type="file" id="stockFile" />
    </div>

    <div class="control-group small">
      <label>Sales Days</label>
      <input type="number" id="salesDays" value="30" />
    </div>

    <div class="control-group small">
      <label>Target SC</label>
      <input type="number" id="targetSC" value="45" />
    </div>

    <div class="control-actions">
      <button id="generateBtn">Generate Reports</button>
      <button id="exportBtn">Export Excel</button>
    </div>
  </div>

  <!-- SC BAND SUMMARY -->
  <div class="card">
    <h3>SC Band Summary</h3>
    <table>
      <tr><th>Band</th><th>Styles</th></tr>
      <tr><td>0–30</td><td id="b0">0</td></tr>
      <tr><td>30–60</td><td id="b30">0</td></tr>
      <tr><td>60–120</td><td id="b60">0</td></tr>
      <tr><td>120+</td><td id="b120">0</td></tr>
    </table>
  </div>

  <input id="search" placeholder="Search style" />

  <!-- TABS -->
  <div class="tabs">
    <button class="tab-btn active" data-tab="demand">Demand</button>
    <button class="tab-btn" data-tab="overstock">Overstock</button>
    <button class="tab-btn" data-tab="sizeanalysis">Size Analysis</button>
    <button class="tab-btn" data-tab="sizecurve">Size Curve</button>
  </div>

  <!-- DEMAND -->
  <div id="demandTab" class="tab-content active">
    <table id="demandTable">
      <thead>
        <tr>
          <th></th>
          <th>Style / SKU</th><th>Sales</th><th>Stock</th>
          <th>DRR</th><th>SC</th><th>Demand</th>
        </tr>
      </thead>
      <tbody></tbody>
    </table>
  </div>

  <!-- OVERSTOCK -->
  <div id="overstockTab" class="tab-content">
    <table id="overstockTable">
      <thead>
        <tr>
          <th></th>
          <th>Style / SKU</th><th>Sales</th><th>Stock</th>
          <th>DRR</th><th>SC</th>
        </tr>
      </thead>
      <tbody></tbody>
    </table>
  </div>

  <!-- SIZE ANALYSIS -->
  <div id="sizeanalysisTab" class="tab-content">
    <table>
      <tr><th>Category</th><th>Units</th><th>% Share</th></tr>
      <tr><td>Normal (S–XXL)</td><td id="normalSales">0</td><td id="normalPct">0%</td></tr>
      <tr><td>Plus1 (3XL–6XL)</td><td id="plus1Sales">0</td><td id="plus1Pct">0%</td></tr>
      <tr><td>Plus2 (7XL–10XL)</td><td id="plus2Sales">0</td><td id="plus2Pct">0%</td></tr>
    </table>
  </div>

  <!-- SIZE CURVE -->
  <div id="sizecurveTab" class="tab-content">
    <div class="help-box">
      <b>How to read this</b><br />
      • Style Demand = units required to reach target SC<br />
      • Allocation is based on actual size sales mix<br />
      • Sizes with higher stock get lower allocation<br />
      • Use these numbers directly for PO size breakup
    </div>
    <table id="sizeCurveTable">
      <thead>
        <tr>
          <th>Style</th><th>Style Demand</th><th>Recommended Buy (Size:Qty)</th>
        </tr>
      </thead>
      <tbody></tbody>
    </table>
  </div>

</div>

<script src="app.js"></script>
</body>
</html>
